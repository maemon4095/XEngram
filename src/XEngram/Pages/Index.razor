@page "/"

<PageTitle>@this.Title</PageTitle>

<ul>
    @foreach (var entry in this.Entries)
    {
        <CascadingValue Value=entry>
            <StrageView></StrageView>
        </CascadingValue>
    }
</ul>

@code {
    private string Title => this.Directory ?? nameof(XEngram);

    [Parameter, SupplyParameterFromQuery]
    public string? Directory { get; set; }

    IEnumerable<IStrageEntry> Entries { get; set; }

    protected override void OnInitialized()
    {
        this.Entries = Enumerable.Repeat(new MockEntry("root", 10), 1);
    }
    class MockEntry : IStrageEntry
    {
        public MockEntry(string name , int depth)
        {
            this.Name = name;
            this.depth = depth;
        }

        public string Name { get; private set; }
        private int depth;

        public IEnumerable<IStrageEntry> Children
        {
            get
            {
                if (depth <= 0) return Enumerable.Empty<IStrageEntry>();
                var count = new Random().Next(10);
                return Enumerable.Range(0, count).Select(
                    i =>
                    {
                        return new MockEntry($"entry_[{depth}]{i}", depth - 1);
                    });
            }
        }
    }
}